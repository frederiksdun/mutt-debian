Origin: http://dev.mutt.org/trac/changeset/897dcc62e4aa
Description: fix problem where mutt_substrdup() was called with the
  start pointer > end pointer, as a result of using SKIPWS(). This
  occurred because the header field had an empty body, so the
  trailing newline was skipped over. The fix is to just skip over
  ascii space and htab.
Bug-Redhat: https://bugzilla.redhat.com/show_bug.cgi?id=1168463#c4
Bug-upstream: http://dev.mutt.org/trac/ticket/3716

CVE-2014-9116

---
 sendlib.c |    6 +++++-
 1 file changed, 5 insertions(+), 1 deletion(-)

Index: b/sendlib.c
===================================================================
--- a/sendlib.c
+++ b/sendlib.c
@@ -1814,7 +1814,11 @@ static int write_one_header (FILE *fp, i
     {
       tagbuf = mutt_substrdup (start, t);
       ++t; /* skip over the colon separating the header field name and value */
-      SKIPWS(t); /* skip over any leading whitespace */
+
+      /* skip over any leading whitespace (WSP, as defined in RFC5322) */
+      while (*t == ' ' || *t == '\t')
+	t++;
+
       valbuf = mutt_substrdup (t, end);
     }
     dprint(4,(debugfile,"mwoh: buf[%s%s] too long, "
